<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="account.report_invoice_document">
        <t t-call="report.external_layout">
            <div class="page" style="font-family: helvetica; font-size: 12px;">
                <!-- DISPLAY COMPANY INFO IF NEEDED  -->
                <div style="color: white; line-height: 20px;">
                    <span t-if="o.company_id.phone">
                        <span style="display: inline-block; width: 120px;">Phone:</span>
                        <span t-field="o.company_id.phone"/>
                        <br/>
                    </span>
                    <span t-if="o.company_id.fax">
                        <span style="display: inline-block; width: 120px;">Fax:</span>
                        <span t-field="o.company_id.fax"/>
                        <br/>
                    </span>
                    <span t-if="o.company_id.website">
                        <span style="display: inline-block; width: 120px;">Website:</span>
                        <span t-field="o.company_id.website"/>
                        <br/>
                    </span>
                    <span t-if="o.company_id.email">
                        <span style="display: inline-block; width: 120px;">Email:</span>
                        <span t-field="o.company_id.email"/>
                        <br/>
                    </span>
                </div>
                <!-- DISPLAY POSTAL ADRESS -->
                <div style="margin-left: 520px; margin-top : 50px; line-height: 20px; font-size: 14px;">
                    <span t-if="o.partner_id.name">
                        <strong>
                            <span t-field="o.partner_id.name"/>
                        </strong>
                        <br/>
                    </span>
                    <!-- CONTACT NAME FOR COMPANY -->
                    <span t-if="o.partner_id.is_company and o.partner_id.child_ids">
                        <span t-field="o.partner_id.child_ids[0].name"/>
                        <br/>
                    </span>
                    <!-- COMPANY NAME FOR CONTACT -->
                    <span t-if="o.partner_id.parent_id">
                        <span t-field="o.partner_id.parent_id.name"/>
                        <br/>
                    </span>
                    <span t-if="o.partner_id.street">
                        <span t-field="o.partner_id.street"/>
                        <br/>
                    </span>
                    <span t-if="o.partner_id.street2">
                        <span t-field="o.partner_id.street2"/>
                        <br/>
                    </span>
                    <span t-if="o.partner_id.zip">
                        <span t-field="o.partner_id.zip"/>
                    </span>
                    <span t-if="o.partner_id.city">
                        <span t-field="o.partner_id.city"/>
                        <br/>
                    </span>
                    <span t-if="o.partner_id.country_id.code != 'CH'">
                        <span t-field="o.partner_id.country_id.name"/>
                        <br/>
                    </span>
                    <div name="reference"/>
                </div>
                <br/>
                <br/>
                <!-- DISPLAY DOCUMENT NAME -->
                <h3>
                    <span t-if="o.type == 'out_invoice' and (o.state == 'open' or o.state == 'paid')">Invoice</span>
                    <span t-if="o.type == 'out_invoice' and o.state == 'proforma2'">PRO-FORMA</span>
                    <span t-if="o.type == 'out_invoice' and o.state == 'draft'">Draft Invoice</span>
                    <span t-if="o.type == 'out_invoice' and o.state == 'cancel'">Cancelled Invoice</span>
                    <span t-if="o.type == 'out_refund'">Refund</span>
                    <span t-if="o.type == 'in_refund'">Supplier Refund</span>
                    <span t-if="o.type == 'in_invoice'">Supplier Invoice</span>
                    <span t-field="o.number"/>
                </h3>
                <br/>
                <!-- DISPLAY DOCUMENT INFO -->
                <table width="820">
                    <thead>
                        <tr>
                            <th style="border: 1px solid #0066FF; width: 205px; background-color: WhiteSmoke; text-align: center; padding: 2px;  font-size: 12px;">
                                <b>Invoice Date</b>
                            </th>
                            <th style="border: 1px solid #0066FF; width: 205px; background-color: WhiteSmoke; text-align: center; padding: 2px;">
                                <b>Payment Terms</b>
                            </th>
                            <th style="border: 1px solid #0066FF; width: 205px; background-color: WhiteSmoke; text-align: center; padding: 2px;">
                                <b>Due Date</b>
                            </th>
                            <th style="border: 1px solid #0066FF; width: 205px; background-color: WhiteSmoke; text-align: center; padding: 2px;">
                                <b>Our VAT</b>
                            </th>
                        </tr>
                    </thead>
                    <tr>
                        <td style="border: 1px solid #0066FF; text-align: center; padding: 5px;">
                            <span t-field="o.date_invoice"/>
                        </td>
                        <td style="border: 1px solid #0066FF; text-align: center; padding: 5px;">
                            <span t-field="o.payment_term_id"/>
                        </td>
                        <td style="border: 1px solid #0066FF; text-align: center; padding: 5px;">
                            <span t-field="o.date_due"/>
                        </td>
                        <td style="border: 1px solid #0066FF; text-align: center; padding: 5px;">
                            <span t-field="o.company_id.vat"/>
                        </td>
                    </tr>
                </table>
                <br/>
                <!-- DISPLAY LINES INFO -->
                <table width="820">
                    <thead>
                        <tr>
                            <th style="border: 1px solid LightSteelBlue; width: 502px; background-color: WhiteSmoke; text-align: left; padding: 2px; padding-left: 10px;">
                                <b>Description</b>
                            </th>
                            <th style="border: 1px solid LightSteelBlue; width: 112px; background-color: WhiteSmoke; text-align: center; padding: 2px;">
                                <b>Quantity</b>
                            </th>
                            <th style="border: 1px solid LightSteelBlue; width: 102px; background-color: WhiteSmoke; text-align: center; padding: 2px;">
                                <b>Unit Price</b>
                            </th>
                            <th style="border: 1px solid LightSteelBlue; width: 102px; background-color: WhiteSmoke; text-align: center; padding: 2px;">
                                <b>Sub total</b>
                            </th>
                        </tr>
                    </thead>
                    <!-- NOT IN USE, SEE LAYOUTED -->
                    <tbody class="invoice_tbody">
                        <tr t-as="l" t-foreach="o.invoice_line">
                            <td>
                                <span t-field="l.name"/>
                            </td>
                            <td>
                                <span t-field="l.quantity"/>
                                <span groups="product.group_uom" t-field="l.uos_id"/>
                            </td>
                            <td class="text-right">
                                <span t-field="l.price_unit"/>
                            </td>
                            <td class="text-right" groups="sale.group_discount_per_so_line">
                                <span t-if="l.discount != 0">
                                    <span t-field="l.discount"/>
                                </span>
                            </td>
                            <td class="text-right">
                                <span t-esc="', '.join(map(lambda x: x.name, l.invoice_line_tax_id))"/>
                            </td>
                            <td class="text-right">
                                <span t-field="l.price_subtotal" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <!-- TAX INFO -->
                <div style="margin-left: 513px; width: 308px; page-break-inside: avoid; margin-top: 10px; font-size: 14px;">
                    <table>
                        <tr>
                            <td style="border: 1px solid LightSteelBlue; text-align: left; padding: 2px; width: 204px;">
                                <strong>Total Without Taxes</strong>
                            </td>
                            <td style="border: 1px solid LightSteelBlue; text-align: right; padding-right: 6px; width: 102px;">
                                <span t-field="o.amount_untaxed" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                            </td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid LightSteelBlue; text-align: left; padding: 2px;">Taxes</td>
                            <td style="border: 1px solid LightSteelBlue; text-align: right; padding-right: 6px;">
                                <span t-field="o.amount_tax" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                            </td>
                        </tr>
                        <tr>
                            <td style="border: 1px solid LightSteelBlue; text-align: left; padding: 2px;">
                                <strong>Total</strong>
                            </td>
                            <td style="border: 1px solid LightSteelBlue; text-align: right; padding-right: 6px;">
                                <span t-field="o.amount_total" t-field-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>
                            </td>
                        </tr>
                    </table>
                </div>
                <br/>
                <!-- BANK INFO -->
                <div style="page-break-inside: avoid;" t-if="o.partner_bank_id">
                    <strong>Bank Relation:</strong>
                    <br/>
                    <span t-if="o.partner_bank_id.bank_name">
                        <span t-field="o.partner_bank_id.bank_name"/>
                        <br/>
                    </span>
                    <span t-if="o.partner_bank_id.acc_number">IBAN : CH64 0900 0000 1754 5075 1
                        
                        
                        
                        <br/></span>
                    <span t-if="o.partner_bank_id.bank_bic">SWIFT : 
                        
                        
                        
                        <span t-field="o.partner_bank_id.bank_bic"/>
                        <br/>
                        <br/>
                        <br/></span>
                </div>
                <p t-if="o.comment">
                    <span t-field="o.comment"/>
                    <br/>
                    <br/>
                </p>
                <p t-if="o.fiscal_position_id">
                    <strong>Fiscal Position:</strong>
                    <span t-field="o.fiscal_position_id"/>
                    <br/>
                    <br/>
                    <p t-if="o.payment_term_id"/>
                    <strong>Relation bancaire:</strong>
                    <span t-field="o.fiscal_position_id.note"/>
                </p>
            </div>
        </t>
    </template>
    <template id="sale_layout.report_invoice_layouted" inherit_id="account.report_invoice_document">
        <xpath expr="//table/tbody[@class='invoice_tbody']" position="replace">
            <t t-as="p" t-foreach="o.sale_layout_lines(invoice_id=o.id)">
                <!-- Name of the category -->
                <t t-call="sale_layout.category_template"/>
                <!-- Lines associated -->
                <t t-as="l" t-foreach="p['lines']">
                    <!-- LINES BY ONS -->
                    <tr style="page-break-inside: avoid;">
                        <td style="border: 1px solid LightSteelBlue; text-align: left; padding: 2px; padding-left: 10px;">
                            <span t-field="l.name"/>
                        </td>
                        <td style="border: 1px solid LightSteelBlue; text-align: right; padding-right: 6px;">
                            <span t-esc="&quot;%0.0f&quot; % l.quantity"/>
                            <span t-field="l.uom_id"/>
                        </td>
                        <td style="border: 1px solid LightSteelBlue; text-align: right; padding-right: 6px;">
                            <span t-field="l.price_unit"/>
                            <!--                             <span t-if="l.abs_discount != 0"><br/><span style="font-size: 10pt;"><i>Rabais 
                                        <span t-esc="&quot;%0.0f&quot; % l.abs_discount"/>.-</i></span></span>-->
                        </td>
                        <td style="border: 1px solid LightSteelBlue; text-align: right; padding-right: 6px;">
                            <span t-field="l.price_subtotal"/>
                            <span t-if="l.discount != 0">
                                <br/>
                                <span style="font-size: 10pt;">
                                    <i>Rabais 
                                        
                                        
                                        <span t-esc="&quot;%0.1f&quot; % l.discount"/>
                                        %</i>
                                </span>
                            </span>
                        </td>
                    </tr>
                </t>
                <!-- Subtotal -->
                <t t-call="sale_layout.subtotal_template">
                    <t t-set="doc" t-value="o"/>
                </t>
                <!-- Separator -->
                <t t-call="sale_layout.separator_template"/>
                <!-- Pagebreak -->
                <t t-if="'pagebreak' in p['category'] and p['category'].pagebreak is True">
                    <t t-if="p_index &lt; p_size - 1">&lt;/tbody&gt;
                    &lt;/table&gt;
                    &lt;p style=&quot;page-break-before:always;&quot;&gt; &lt;/p&gt;
                    &lt;table class=&quot;table table-condensed&quot;&gt;

                        
                        
                        <thead>
                            <tr>
                                <th style="border: 1px solid LightSteelBlue; width: 502px; background-color: WhiteSmoke; text-align: left; padding: 2px; padding-left: 10px;">
                                    <b>Description</b></th>
                                <th style="border: 1px solid LightSteelBlue; width: 112px; background-color: WhiteSmoke; text-align: center; padding: 2px;">
                                    <b>Quantity</b>
                                </th>
                                <th style="border: 1px solid LightSteelBlue; width: 102px; background-color: WhiteSmoke; text-align: center; padding: 2px;">
                                    <b>Unit Price</b>
                                </th>
                                <th style="border: 1px solid LightSteelBlue; width: 102px; background-color: WhiteSmoke; text-align: center; padding: 2px;">
                                    <b>Sub total</b>
                                </th>
                            </tr>
                        </thead>&lt;tbody&gt;</t>
                </t>
            </t>
        </xpath>
    </template>
    <template id="sale_layout.subtotal_template">
        <!-- Subtotal -->
        <t t-if="'subtotal' in p['category'] and p['category'].subtotal is True">
            <tr class="text-right">
                <td colspan="100" style="font-size: 14px; padding: 2px; width: 20px;">
                    <strong>Subtotal: </strong>
                    <span t-esc="p['subtotal']" t-esc-options="{&quot;widget&quot;: &quot;monetary&quot;, &quot;display_currency&quot;: &quot;o.currency_id&quot;}"/>(ht)</td>
            </tr>
        </t>
    </template>
    <template id="sale_layout.category_template">
        <!-- Category name -->
        <t t-if="p['category']">
            <tr>
                <td class="active" colspan="100" style="font-weight: bold; border: 1px solid LightSteelBlue; padding-left: 8px;">
                    <i>
                        <t t-if="p['category'].name">
                            <t t-esc="p['category'].name"/>
                        </t>
                        <t t-if="not p['category'].name">Uncategorized
                </t>
                    </i>
                </td>
            </tr>
        </t>
    </template>
</odoo>